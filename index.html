<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Voting</title>
        <script src="https://code.jquery.com/jquery.min.js"></script>
        <script src="Vote.js"></script>
    </head>
    <body>
        <strong><big>2018 이천고 학생회장 모의선거</big></strong> <br />
        <input type="number" id="vote">
        <button id="send" onclick="transfer();" type="button">Send</button><br /><br><br>
        <input type="password" id="privatekey"><br>

        <script>
          let contract;
          let web3 = new Web3(new Web3.providers.HttpProvider('https://ropsten.infura.io/'))
          contract = new web3.eth.Contract(ABI,'0x8290807bd15a6c52fcd371be36ead9e0529b82c4');

          function transfer() {
            let key = document.getElementById('privatekey').value;
            document.getElementById('privatekey').value="";
            web3.eth.accounts.wallet.add('0x'+key);

            contract.methods.vote(document.getElementById('vote').value).send({
              from: web3.eth.accounts.wallet[0].address,
              gasPrice: 5,
              gas: 210000,
              value: 0
            }, function(err,res){
              if(!err) location.href="done.html";
              else console.log(err);
            });

            web3.eth.accounts.wallet.clear;
          }
        </script>
    </body>
</html>
